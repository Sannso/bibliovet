import{l as m,x as z,t as B}from"./preact.module.mNte_dLy.js";import{T as E}from"./hooks.module.DpvEAJYN.js";var D=Symbol.for("preact-signals");function g(){if(c>1)c--;else{for(var n,i=!1;y!==void 0;){var e=y;for(y=void 0,U++;e!==void 0;){var t=e.o;if(e.o=void 0,e.f&=-3,!(8&e.f)&&C(e))try{e.c()}catch(s){i||(n=s,i=!0)}e=t}}if(U=0,c--,i)throw n}}function H(n){if(c>0)return n();c++;try{return n()}finally{g()}}var f=void 0,y=void 0,c=0,U=0,$=0;function O(n){if(f!==void 0){var i=n.n;if(i===void 0||i.t!==f)return i={i:0,S:n,p:f.s,n:void 0,t:f,e:void 0,x:void 0,r:i},f.s!==void 0&&(f.s.n=i),f.s=i,n.n=i,32&f.f&&n.S(i),i;if(i.i===-1)return i.i=0,i.n!==void 0&&(i.n.p=i.p,i.p!==void 0&&(i.p.n=i.n),i.p=f.s,i.n=void 0,f.s.n=i,f.s=i),i}}function o(n){this.v=n,this.i=0,this.n=void 0,this.t=void 0}o.prototype.brand=D;o.prototype.h=function(){return!0};o.prototype.S=function(n){this.t!==n&&n.e===void 0&&(n.x=this.t,this.t!==void 0&&(this.t.e=n),this.t=n)};o.prototype.U=function(n){if(this.t!==void 0){var i=n.e,e=n.x;i!==void 0&&(i.x=e,n.e=void 0),e!==void 0&&(e.e=i,n.x=void 0),n===this.t&&(this.t=e)}};o.prototype.subscribe=function(n){var i=this;return S(function(){var e=i.value,t=f;f=void 0;try{n(e)}finally{f=t}})};o.prototype.valueOf=function(){return this.value};o.prototype.toString=function(){return this.value+""};o.prototype.toJSON=function(){return this.value};o.prototype.peek=function(){var n=f;f=void 0;try{return this.value}finally{f=n}};Object.defineProperty(o.prototype,"value",{get:function(){var n=O(this);return n!==void 0&&(n.i=this.i),this.v},set:function(n){if(n!==this.v){if(U>100)throw new Error("Cycle detected");this.v=n,this.i++,$++,c++;try{for(var i=this.t;i!==void 0;i=i.x)i.t.N()}finally{g()}}}});function A(n){return new o(n)}function C(n){for(var i=n.s;i!==void 0;i=i.n)if(i.S.i!==i.i||!i.S.h()||i.S.i!==i.i)return!0;return!1}function j(n){for(var i=n.s;i!==void 0;i=i.n){var e=i.S.n;if(e!==void 0&&(i.r=e),i.S.n=i,i.i=-1,i.n===void 0){n.s=i;break}}}function q(n){for(var i=n.s,e=void 0;i!==void 0;){var t=i.p;i.i===-1?(i.S.U(i),t!==void 0&&(t.n=i.n),i.n!==void 0&&(i.n.p=t)):e=i,i.S.n=i.r,i.r!==void 0&&(i.r=void 0),i=t}n.s=e}function v(n){o.call(this,void 0),this.x=n,this.s=void 0,this.g=$-1,this.f=4}(v.prototype=new o).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===$))return!0;if(this.g=$,this.f|=1,this.i>0&&!C(this))return this.f&=-2,!0;var n=f;try{j(this),f=this;var i=this.x();(16&this.f||this.v!==i||this.i===0)&&(this.v=i,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return f=n,q(this),this.f&=-2,!0};v.prototype.S=function(n){if(this.t===void 0){this.f|=36;for(var i=this.s;i!==void 0;i=i.n)i.S.S(i)}o.prototype.S.call(this,n)};v.prototype.U=function(n){if(this.t!==void 0&&(o.prototype.U.call(this,n),this.t===void 0)){this.f&=-33;for(var i=this.s;i!==void 0;i=i.n)i.S.U(i)}};v.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var n=this.t;n!==void 0;n=n.x)n.t.N()}};Object.defineProperty(v.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var n=O(this);if(this.h(),n!==void 0&&(n.i=this.i),16&this.f)throw this.v;return this.v}});function k(n){return new v(n)}function P(n){var i=n.u;if(n.u=void 0,typeof i=="function"){c++;var e=f;f=void 0;try{i()}catch(t){throw n.f&=-2,n.f|=8,N(n),t}finally{f=e,g()}}}function N(n){for(var i=n.s;i!==void 0;i=i.n)i.S.U(i);n.x=void 0,n.s=void 0,P(n)}function I(n){if(f!==this)throw new Error("Out-of-order effect");q(this),f=n,this.f&=-2,8&this.f&&N(this),g()}function b(n){this.x=n,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}b.prototype.c=function(){var n=this.S();try{if(8&this.f||this.x===void 0)return;var i=this.x();typeof i=="function"&&(this.u=i)}finally{n()}};b.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,P(this),j(this),c++;var n=f;return f=this,I.bind(this,n)};b.prototype.N=function(){2&this.f||(this.f|=2,this.o=y,y=this)};b.prototype.d=function(){this.f|=8,1&this.f||N(this)};function S(n){var i=new b(n);try{i.c()}catch(e){throw i.d(),e}return i.d.bind(i)}var M,x,T=[];S(function(){M=this.N})();function p(n,i){m[n]=i.bind(null,m[n]||function(){})}function w(n){x&&x(),x=n&&n.S()}function F(n){var i=this,e=n.data,t=L(e);t.value=e;var s=E(function(){for(var d=i,h=i.__v;h=h.__;)if(h.__c){h.__c.__$f|=4;break}var a=k(function(){var _=t.value.value;return _===0?0:_===!0?"":_||""}),l=k(function(){return!B(a.value)}),J=S(function(){if(this.N=G,l.value){var _=a.value;d.base&&d.base.nodeType===3&&(d.base.data=_)}}),V=i.__$u.d;return i.__$u.d=function(){J(),V.call(this)},[l,a]},[]),r=s[0],u=s[1];return r.value?u.peek():u.value}F.displayName="_st";Object.defineProperties(o.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:F},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});p("__b",function(n,i){if(typeof i.type=="string"){var e,t=i.props;for(var s in t)if(s!=="children"){var r=t[s];r instanceof o&&(e||(i.__np=e={}),e[s]=r,t[s]=r.peek())}}n(i)});p("__r",function(n,i){w();var e,t=i.__c;t&&(t.__$f&=-2,(e=t.__$u)===void 0&&(t.__$u=e=function(s){var r;return S(function(){r=this}),r.c=function(){t.__$f|=1,t.setState({})},r}())),w(e),n(i)});p("__e",function(n,i,e,t){w(),n(i,e,t)});p("diffed",function(n,i){w();var e;if(typeof i.type=="string"&&(e=i.__e)){var t=i.__np,s=i.props;if(t){var r=e.U;if(r)for(var u in r){var d=r[u];d!==void 0&&!(u in t)&&(d.d(),r[u]=void 0)}else r={},e.U=r;for(var h in t){var a=r[h],l=t[h];a===void 0?(a=K(e,h,l,s),r[h]=a):a.o(l,s)}}}n(i)});function K(n,i,e,t){var s=i in n&&n.ownerSVGElement===void 0,r=A(e);return{o:function(u,d){r.value=u,t=d},d:S(function(){this.N=G;var u=r.value.value;t[i]!==u&&(t[i]=u,s?n[i]=u:u?n.setAttribute(i,u):n.removeAttribute(i))})}}p("unmount",function(n,i){if(typeof i.type=="string"){var e=i.__e;if(e){var t=e.U;if(t){e.U=void 0;for(var s in t){var r=t[s];r&&r.d()}}}}else{var u=i.__c;if(u){var d=u.__$u;d&&(u.__$u=void 0,d.d())}}n(i)});p("__h",function(n,i,e,t){(t<3||t===9)&&(i.__$f|=2),n(i,e,t)});z.prototype.shouldComponentUpdate=function(n,i){var e=this.__$u,t=e&&e.s!==void 0;for(var s in i)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var r=2&this.__$f;if(!(t||r||4&this.__$f)||1&this.__$f)return!0}else if(!(t||4&this.__$f)||3&this.__$f)return!0;for(var u in n)if(u!=="__source"&&n[u]!==this.props[u])return!0;for(var d in this.props)if(!(d in n))return!0;return!1};function L(n){return E(function(){return A(n)},[])}var Q=function(n){queueMicrotask(function(){queueMicrotask(n)})};function R(){H(function(){for(var n;n=T.shift();)M.call(n)})}function G(){T.push(this)===1&&(m.requestAnimationFrame||Q)(R)}export{o as Signal,H as batch,k as computed,S as effect,A as signal,L as useSignal};
